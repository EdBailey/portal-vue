!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("vue")):"function"==typeof define&&define.amd?define(["vue"],e):t.PortalVue=e(t.Vue)}(this,function(t){"use strict";function e(t){for(var e=t.hasAttributes()?t.attributes:[],n={},r=0;r<e.length;r++){var o=e[r];o.value&&(n[o.name]=""===o.value||o.value)}return n}function n(t){return Array.isArray(t)||"object"===(void 0===t?"undefined":s(t))?Object.freeze(t):t}function r(t){var e=[],n=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var a=i.value;e=e.concat(a.passengers)}}catch(t){r=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return e}function o(t,e){return function(){t&&t.apply(this,arguments),e&&e.apply(this,arguments)}}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.component(e.portalName||"portal",w),t.component(e.portalTargetName||"portal-target",m)}t=t&&"default"in t?t.default:t;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},f={},p=function(){function e(t){a(this,e),this.transports=t}return u(e,[{key:"open",value:function(e){var r=e.to,o=e.from,i=e.passengers;if(r&&o&&i){e.passengers=n(i);-1===Object.keys(this.transports).indexOf(r)&&t.set(this.transports,r,[]);var s=this.getTransportIndex(e),a=this.transports[r].slice(0);-1===s?a.push(e):a[s]=e,a.sort(function(t,e){return t.order-e.order}),this.transports[r]=a}}},{key:"close",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.to,r=t.from;if(n&&r&&this.transports[n])if(e)this.transports[n]=[];else{var o=this.getTransportIndex(t);if(o>=0){var i=this.transports[n].slice(0);i.splice(o,1),this.transports[n]=i}}}},{key:"hasTarget",value:function(t){return this.transports.hasOwnProperty(t)}},{key:"hasContentFor",value:function(t){return!!this.transports[t]&&this.getContentFor(t).length>0}},{key:"getSourceFor",value:function(t){return this.transports[t]&&this.transports[t][0].from}},{key:"getContentFor",value:function(t){var e=this.transports[t];if(e)return r(e)}},{key:"getTransportIndex",value:function(t){var e=t.to,n=t.from;for(var r in this.transports[e])if(this.transports[e][r].from===n)return r;return-1}}]),e}(),c=new p(f),d=/^(attrs|props|on|nativeOn|class|style|hook)$/,g=function(t){return t.reduce(function(t,e){var n,r,i,s,a;for(i in e)if(n=t[i],r=e[i],n&&d.test(i))if("class"===i&&("string"==typeof n&&(a=n,t[i]=n={},n[a]=!0),"string"==typeof r&&(a=r,e[i]=r={},r[a]=!0)),"on"===i||"nativeOn"===i||"hook"===i)for(s in r)n[s]=o(n[s],r[s]);else if(Array.isArray(n))t[i]=n.concat(r);else if(Array.isArray(r))t[i]=[n].concat(r);else for(s in r)n[s]=r[s];else t[i]=e[i];return t},{})},m={abstract:!0,name:"portalTarget",props:{attributes:{type:Object},multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slim:{type:Boolean,default:!1},tag:{type:String,default:"div"},transition:{type:[Boolean,String,Object],default:!1},transitionEvents:{type:Object,default:function(){return{}}}},data:function(){return{transports:c.transports,firstRender:!0}},created:function(){this.transports[this.name]||this.$set(this.transports,this.name,[])},mounted:function(){var t=this;this.unwatch=this.$watch("ownTransports",this.emitChange),this.updateAttributes(),this.$nextTick(function(){t.transition&&(t.firstRender=!1)})},updated:function(){this.updateAttributes()},beforeDestroy:function(){this.unwatch(),this.$el.innerHTML=""},methods:{updateAttributes:function(){if(this.attributes){var t=this.attributes,e=this.$el;t.class&&(t.class.trim().split(" ").forEach(function(t){e.classList.add(t)}),delete t.class);for(var n=Object.keys(t),r=0;r<n.length;r++)e.setAttribute(n[r],t[n[r]])}},emitChange:function(t,e){if(this.multiple)this.$emit("change",[].concat(h(t)),[].concat(h(e)));else{var n=0===t.length?void 0:t[0],r=0===e.length?void 0:e[0];this.$emit("change",l({},n),l({},r))}}},computed:{ownTransports:function(){var t=this.transports[this.name]||[];return this.multiple?t:0===t.length?[]:[t[t.length-1]]},passengers:function(){return r(this.ownTransports)},children:function(){return 0!==this.passengers.length?this.passengers:this.$slots.default||[]},noWrapper:function(){var t=!this.attributes&&this.slim;return t&&this.children.length>1&&console.warn("[portal-vue]: PortalTarget with `slim` option received more than one child element."),t},withTransition:function(){return!!this.transition},transitionData:function(){var t=this.transition,e={};return this.firstRender&&"object"===s(this.transition)&&!this.transition.appear?(e.props={name:"__notranstition__portal-vue__"},e):("string"==typeof t?e.props={name:t}:"object"===(void 0===t?"undefined":s(t))&&(e.props=t),this.renderSlim&&(e.props.tag=this.tag),e.on=this.transitionEvents,e)}},render:function(t){var e=this.noWrapper?"transition":"transition-group",n=this.tag;if(this.withTransition)return t(e,g([this.transitionData,{class:"vue-portal-target"}]),[this.children]);var r=this.ownTransports.length;return this.noWrapper?this.children[0]:t(n,{class:"vue-portal-target",key:r},[this.children])}},y="undefined"!=typeof window,v=y&&window.parent,b=1,w={abstract:!0,name:"portal",props:{disabled:{type:Boolean,default:!1},name:{type:String,default:function(){return String(b++)}},order:{type:Number,default:0},slim:{type:Boolean,default:!1},tag:{type:[String],default:"DIV"},targetEl:{type:y?v?[String,HTMLElement,window.parent.HTMLElement]:[String,HTMLElement]:String},to:{type:String,default:function(){return String(Math.round(1e7*Math.random()))}}},mounted:function(){this.targetEl&&this.mountToTarget(),this.disabled||this.sendUpdate(),window.addEventListener("unload",this.$destroy)},updated:function(){this.disabled?this.clear():this.sendUpdate()},beforeDestroy:function(){this.clear(),this.mountedComp&&this.mountedComp.$destroy()},watch:{to:function(t,e){e&&this.clear(e),this.sendUpdate()},targetEl:function(t,e){this.mountToTarget()}},methods:{sendUpdate:function(){this.to?this.$slots.default?c.open({from:this.name,to:this.to,passengers:[].concat(h(this.$slots.default)),order:this.order}):this.clear():this.to||this.targetEl||console.warn("[vue-portal]: You have to define a target via the `to` prop.")},clear:function(t){c.close({from:this.name,to:t||this.to})},mountToTarget:function(){var n=void 0,r=this.targetEl;if("string"==typeof r)n=document.querySelector(this.targetEl);else{if(!(r instanceof HTMLElement||v&&r instanceof parent.HTMLElement))return void console.warn("[vue-portal]: value of targetEl must be of type String or HTMLElement");n=r}var o=e(n);if(n){var i=new t(l({},m,{parent:this,propsData:{name:this.to,tag:n.tagName,attributes:o}}));i.$mount(n),this.mountedComp=i}else console.warn("[vue-portal]: The specified targetEl "+this.targetEl+" was not found")}},render:function(t){var e=this.$slots.default||[],n=this.tag;return e.length&&this.disabled?e.length<=1&&this.slim?e[0]:t(n,null,[e]):t(n,{class:"v-portal",style:"display: none",key:"v-portal-placeholder"},[])}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use({install:i}),{install:i,Portal:w,PortalTarget:m,Wormhole:c}});
